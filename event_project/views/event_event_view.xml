<?xml version="1.0"?>
<openerp>
  <data>

        <record id="act_event_task_list" model="ir.actions.act_window">
            <field name="res_model">project.task</field>
            <field name="view_type">form</field>
            <field name="name">Tareas</field>
            <field name="view_mode">gantt,kanban,tree,form,calendar,graph</field>
            <field name="context">{'search_default_event': active_id, 'default_event': active_id}</field>
        </record>

        <record model="ir.ui.view" id="view_event_form_project">
            <field name="name">Events project</field>
            <field name="model">event.event</field>
            <field name="inherit_id" ref="event.view_event_form"/>
            <field name="arch" type="xml">

                <field name="date_tz" position="after">
                    <field name="project" attrs="{'invisible':[('project_template','=',False)]}"/>
                    <field name="project_template" attrs="{'readonly':[('project','!=',False)]}"/>
                </field>

                <notebook position="inside">
                    <page string="Tareas" attrs="{'invisible':[('project','=',False)]}">
                        <field name="tasks" nolabel="1" context="{'search_default_project_id': project}"/>
                    </page>
                </notebook>
                <div class="oe_right oe_button_box" position="inside">
                    <button name="%(event_project.act_event_task_list)d"
                        type="action"
                        class="oe_stat_button oe_inline"
                        icon="fa-tasks" attrs="{'invisible':[('project','=',False)]}" context="{'search_default_project_id': project}">
                        <field name="count_tasks" widget="statinfo" string="Tareas" context="{'search_default_project_id': project}"/>
                    </button>
                </div>
            </field>
        </record>
  </data>
</openerp>